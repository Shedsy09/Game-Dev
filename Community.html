<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GameHub_Community</title>
  <meta name="description" content="GameHub Community — posts, events, trending topics, and live activity." />
  <style>
    :root{
      --bg:#070708; --panel:#0f1113; --muted:#98a0a6; --accent:#ff3c00; --glass:rgba(255,255,255,0.03); --radius:12px; --shadow:0 10px 30px rgba(0,0,0,0.6); font-family:Inter, Poppins, system-ui, -apple-system, Roboto, 'Helvetica Neue', Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:linear-gradient(180deg,var(--bg),#0b0b0b);color:#e9eef1;padding:28px;display:flex;justify-content:center}
    .wrap{width:100%;max-width:1200px}

    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:18px}
    header h1{margin:0;font-size:1.4rem;color:var(--accent);letter-spacing:1px}
    header .sub{color:var(--muted);font-size:0.95rem}

    .layout{display:grid;grid-template-columns:1fr 320px;gap:18px}

    /* Composer */
    .composer{background:var(--panel);padding:14px;border-radius:var(--radius);box-shadow:var(--shadow);border:1px solid rgba(255,255,255,0.02);margin-bottom:12px}
    .composer textarea{width:100%;min-height:88px;background:transparent;border:0;color:inherit;resize:vertical;font-size:0.98rem}
    .composer .row{display:flex;justify-content:space-between;align-items:center;gap:10px;margin-top:10px}
    .composer .actions{display:flex;gap:8px}
    .btn{background:var(--glass);border:0;color:inherit;padding:8px 12px;border-radius:10px;cursor:pointer;font-weight:600}
    .btn.primary{background:linear-gradient(90deg,var(--accent),#ff6b3b);color:#fff}
    .uploader{display:flex;gap:8px;align-items:center}
    .uploader input[type=file]{display:none}
    .avatar{width:40px;height:40px;border-radius:10px;background:linear-gradient(135deg,#222,#333);display:flex;align-items:center;justify-content:center;font-weight:700}

    /* Feed */
    .feed{display:flex;flex-direction:column;gap:12px}
    .post{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,0.02);box-shadow:var(--shadow)}
    .post .meta{display:flex;gap:10px;align-items:center}
    .post .meta .name{font-weight:700}
    .post .meta .time{color:var(--muted);font-size:0.9rem}
    .post .content{margin-top:10px;font-size:0.98rem;line-height:1.45}
    .post img{width:100%;border-radius:8px;margin-top:10px}
    .post .actions{display:flex;gap:10px;margin-top:12px;align-items:center}
    .icon{opacity:0.95}
    .pill{background:rgba(255,255,255,0.03);padding:6px 8px;border-radius:999px;font-size:0.85rem;color:var(--muted)}

    /* Sidebar */
    .sidebar{display:flex;flex-direction:column;gap:12px}
    .card{background:var(--panel);padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,0.02);box-shadow:var(--shadow)}
    .tags{display:flex;flex-wrap:wrap;gap:8px}
    .tag{padding:6px 10px;border-radius:999px;background:rgba(255,255,255,0.02);cursor:pointer}
    .events{display:flex;flex-direction:column;gap:8px}
    .event{display:flex;justify-content:space-between;align-items:center;padding:8px;border-radius:8px;background:linear-gradient(180deg,rgba(255,255,255,0.01),transparent)}

    footer{margin-top:18px;color:var(--muted);font-size:0.9rem;text-align:center}

    /* small screens */
    @media (max-width:980px){
      .layout{grid-template-columns:1fr}
    }

    /* simple transitions */
    .btn, .tag{transition:transform .12s ease, background .12s ease}
    .btn:active, .tag:active{transform:translateY(1px)}

    /* comments */
    .comments{margin-top:10px;padding-top:10px;border-top:1px solid rgba(255,255,255,0.02)}
    .comment{display:flex;gap:8px;margin-top:8px}
    .comment .txt{background:rgba(255,255,255,0.02);padding:8px;border-radius:8px}
    .muted{color:var(--muted)}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Community</h1>
        <div class="sub">Connect with players — share clips, discuss strategies, and join events.</div>
      </div>
      <div class="sub">Signed in as <strong>ShadowReign</strong></div>
    </header>

    <div class="layout">
      <section>
        <div class="composer" id="composer">
          <div style="display:flex;gap:12px;align-items:flex-start">
            <div class="avatar">SR</div>
            <div style="flex:1">
              <textarea id="post-text" placeholder="Share a clip, screenshot, or a quick update..." aria-label="Create post"></textarea>
              <div class="row">
                <div class="uploader">
                  <label class="btn" for="file-input">Attach</label>
                  <input id="file-input" type="file" accept="image/*,video/*" />
                  <div class="pill muted" id="file-name" style="display:none"></div>
                </div>
                <div class="actions">
                  <button id="btn-post" class="btn primary">Post</button>
                  <button id="btn-clear" class="btn">Clear</button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="feed" id="feed" aria-live="polite">
          <!-- posts injected here -->
        </div>

      </section>

      <aside class="sidebar">
        <div class="card">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
            <div><strong>Trending</strong></div>
            <div class="muted">Filter</div>
          </div>
          <div class="tags" id="tags">
            <!-- tags -->
          </div>
        </div>

        <div class="card">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px"><strong>Events</strong><span class="muted">Upcoming</span></div>
          <div class="events" id="events"></div>
        </div>

        <div class="card">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px"><strong>Active Streams</strong><span class="muted">Live</span></div>
          <div id="streams">
            <!-- simple stream list -->
          </div>
        </div>
      </aside>
    </div>

    <footer>© 2025 GameHub — Community</footer>
  </div>

  <template id="post-tpl">
    <article class="post" data-id="%id%">
      <div class="meta">
        <div class="avatar" aria-hidden="true">%initials%</div>
        <div style="flex:1">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div><span class="name">%name%</span> <span class="muted">• %time%</span></div>
            <div class="pill">%tag%</div>
          </div>
          <div class="content">%content%</div>
        </div>
      </div>
      %media%
      <div class="actions">
        <button class="btn action-like">Like (<span class="like-count">%likes%</span>)</button>
        <button class="btn action-comment">Comments (<span class="comment-count">%comments%</span>)</button>
        <div style="margin-left:auto;color:var(--muted);font-size:0.9rem">%timeago%</div>
      </div>
      <div class="comments" style="display:none"></div>
    </article>
  </template>

  <script>
    // Demo data
    const SAMPLE_TAGS = ['#HeistNight','#RacingLeague','#Patch2.4','#StreamerSpotlight','#OpenWorldMods','#ControllerTips'];
    const SAMPLE_EVENTS = [
      {id:'e1',title:'Heist Night Tournament',date:'2025-10-18',desc:'Compete in 4v4 heists for cash prizes.'},
      {id:'e2',title:'Speedrun Weekend',date:'2025-10-25',desc:'Beat tracks and win the leaderboard.'}
    ];
    const SAMPLE_STREAMS = [
      {id:'s1',name:'NovaBlade',game:'Neon City Chase',viewers:420},
      {id:'s2',name:'CrimsonWolf',game:'Skyline Heist',viewers:128}
    ];

    // Basic post data; persisted in localStorage for demo
    const DEFAULT_POSTS = [
      {id:'p1',name:'ShadowReign',initials:'SR',time:'2025-10-01',tag:'#HeistNight',content:'Pulled off the cleanest rooftop extraction today. Tips: always scope the escape routes before you commit.',media:null,likes:12,comments:[{by:'NovaBlade',txt:'Nice job!'}, {by:'IronViper',txt:'Show clip?'}]},
      {id:'p2',name:'NovaBlade',initials:'NB',time:'2025-09-28',tag:'#RacingLeague',content:'New tune for the Drift King setup — lowered suspension + turbo. Shaved 1.2s off my best lap.',media:null,likes:8,comments:[]}
    ];

    const LS_KEY = 'gamehub.community.v1';
    function load(){
      try{const raw=localStorage.getItem(LS_KEY); if(raw) return JSON.parse(raw)}catch(e){} return DEFAULT_POSTS;
    }
    function save(data){ try{localStorage.setItem(LS_KEY,JSON.stringify(data))}catch(e){console.warn(e)} }

    let posts = load();

    // Render helpers
    const feed = document.getElementById('feed');
    const tagsEl = document.getElementById('tags');
    const eventsEl = document.getElementById('events');
    const streamsEl = document.getElementById('streams');

    function renderTags(){
      tagsEl.innerHTML='';
      SAMPLE_TAGS.forEach(t=>{
        const b=document.createElement('button'); b.className='tag'; b.textContent=t; b.addEventListener('click',()=>filterByTag(t)); tagsEl.appendChild(b);
      });
    }

    function renderEvents(){
      eventsEl.innerHTML='';
      SAMPLE_EVENTS.forEach(e=>{
        const div=document.createElement('div'); div.className='event';
        div.innerHTML=`<div><strong>${e.title}</strong><div class='muted' style='font-size:0.9rem'>${e.desc}</div></div><div class='muted'>${e.date}</div>`;
        eventsEl.appendChild(div);
      });
    }

    function renderStreams(){
      streamsEl.innerHTML='';
      SAMPLE_STREAMS.forEach(s=>{
        const d=document.createElement('div'); d.className='event'; d.innerHTML=`<div><strong>${s.name}</strong><div class='muted' style='font-size:0.9rem'>${s.game}</div></div><div class='pill'>${s.viewers} live</div>`; streamsEl.appendChild(d);
      });
    }

    function renderFeed(list=posts){
      feed.innerHTML='';
      if(!list.length){ feed.innerHTML='<div class="muted">No posts yet. Be the first to post.</div>'; return }
      const tpl=document.getElementById('post-tpl').innerHTML;
      list.slice().reverse().forEach(p=>{
        const media = p.media ? (p.media.type.startsWith('image') ? `<img src="${p.media.url}" alt="post media"/>` : `<video src="${p.media.url}" controls style='width:100%;border-radius:8px'></video>`) : '';
        let html = tpl.replace(/%id%/g,p.id).replace('%initials%',escapeHtml(p.initials||p.name.slice(0,2))).replace('%name%',escapeHtml(p.name)).replace('%time%',escapeHtml(p.time)).replace('%tag%',escapeHtml(p.tag||'')).replace('%content%',escapeHtml(p.content)).replace('%media%',media).replace('%likes%',p.likes||0).replace('%comments%',(p.comments||[]).length).replace('%timeago%','');
        const wrapper = document.createElement('div'); wrapper.innerHTML = html; const postEl = wrapper.firstElementChild;
        // wire actions
        const likeBtn = postEl.querySelector('.action-like');
        const commentBtn = postEl.querySelector('.action-comment');
        const commentsWrap = postEl.querySelector('.comments');

        likeBtn.addEventListener('click', ()=>{
          p.likes = (p.likes||0)+1; save(posts); renderFeed();
        });

        commentBtn.addEventListener('click', ()=>{
          if(commentsWrap.style.display==='none'){ commentsWrap.style.display='block'; renderComments(p, commentsWrap) } else { commentsWrap.style.display='none' }
        });

        feed.appendChild(postEl);
      });
    }

    function renderComments(post, container){
      container.innerHTML='';
      const existing = post.comments||[];
      existing.forEach(c=>{
        const div=document.createElement('div'); div.className='comment'; div.innerHTML=`<div class='avatar'>${c.by.slice(0,2)}</div><div class='txt'><strong>${c.by}</strong><div>${escapeHtml(c.txt)}</div></div>`; container.appendChild(div);
      });
      // input
      const inpWrap = document.createElement('div'); inpWrap.style.display='flex'; inpWrap.style.gap='8px'; inpWrap.style.marginTop='8px';
      const input = document.createElement('input'); input.placeholder='Write a comment...'; input.style.flex='1'; input.style.padding='8px'; input.style.borderRadius='8px'; input.style.border='0'; input.style.background='rgba(255,255,255,0.02)';
      const btn = document.createElement('button'); btn.className='btn primary'; btn.textContent='Reply';
      btn.addEventListener('click', ()=>{ if(!input.value) return; existing.push({by:'You',txt:input.value}); save(posts); renderFeed(); });
      inpWrap.appendChild(input); inpWrap.appendChild(btn); container.appendChild(inpWrap);
    }

    // Composer actions
    const fileInput = document.getElementById('file-input');
    const fileName = document.getElementById('file-name');
    let stagedMedia = null;
    fileInput.addEventListener('change', (e)=>{
      const f = e.target.files[0]; if(!f) return; fileName.style.display='inline-block'; fileName.textContent = f.name; // create object URL for demo
      const url = URL.createObjectURL(f); stagedMedia = {url, type: f.type};
    });

    document.getElementById('btn-post').addEventListener('click', ()=>{
      const txt = document.getElementById('post-text').value.trim(); if(!txt && !stagedMedia){ alert('Write something or attach media'); return }
      const id = 'p'+Date.now(); const now = new Date().toISOString().slice(0,10);
      const newPost = {id,name:'You',initials:'YO',time:now,tag:'#General',content:txt,media:stagedMedia,likes:0,comments:[]};
      posts.push(newPost); save(posts); // reset composer
      document.getElementById('post-text').value = '';
      fileInput.value = ''; fileName.style.display='none'; stagedMedia = null;
      renderFeed();
    });

    document.getElementById('btn-clear').addEventListener('click', ()=>{ document.getElementById('post-text').value=''; fileInput.value=''; fileName.style.display='none'; stagedMedia=null });

    // filtering by tag
    function filterByTag(tag){ const filtered = posts.filter(p=> (p.tag||'').toLowerCase() === tag.toLowerCase()); renderFeed(filtered.length?filtered:posts); }

    function escapeHtml(s){ return String(s).replace(/[&<>"']/g,function(c){return{'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[c]}); }

    // init
    renderTags(); renderEvents(); renderStreams(); renderFeed();
  </script>
</body>
</html>
